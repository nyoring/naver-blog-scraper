<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>브라우저 설치 - 네이버 블로그 스크래퍼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        accent: '#00C853',
                        primary: '#000000',
                        'text-sub': '#333333',
                    },
                    fontFamily: {
                        sans: ['Pretendard', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'sans-serif'],
                        mono: ['Courier New', 'monospace'],
                    },
                    boxShadow: {
                        'brutal': '4px 4px 0 black',
                        'brutal-accent': '4px 4px 0 #00C853',
                        'brutal-sm': '4px 4px 0 rgba(0,0,0,0.2)',
                    }
                }
            }
        }
    </script>
</head>

<body class="font-sans bg-white text-black min-h-screen">
    <div class="max-w-[1200px] mx-auto px-4 py-6 md:px-4 md:py-4">
        <!-- Header -->
        <div class="pb-6 border-b-[3px] border-black mb-8">
            <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                <div>
                    <div class="flex items-center gap-2 mb-2">
                        <div class="w-3 h-3 bg-accent border border-black transform rotate-45"></div>
                        <span class="text-[10px] font-bold tracking-[0.2em] text-[#666] uppercase">B-Scraper v2.0</span>
                    </div>
                    <h1 class="text-3xl md:text-4xl font-black text-black tracking-tight leading-none">
                        네이버 블로그 <span class="relative inline-block text-accent">
                            스크래퍼
                            <span class="absolute bottom-1 left-0 w-full h-[8px] bg-black/5 -z-10 skew-x-12"></span>
                        </span>
                    </h1>
                </div>
            </div>
        </div>

        <!-- Setup Card -->
        <div class="max-w-[600px] mx-auto">
            <div class="bg-white border-2 border-black p-8 shadow-[4px_4px_0_0_black] rounded-none">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-4 h-4 bg-accent border border-black transform rotate-45"></div>
                    <h2 class="text-xl font-black text-black uppercase tracking-tight">브라우저 엔진 설치</h2>
                </div>

                <p class="text-sm text-text-sub leading-relaxed mb-6" id="statusMsg">
                    처음 실행 시 Chromium 브라우저를 다운로드합니다. (~400MB)
                </p>

                <!-- Progress -->
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs font-black text-black uppercase tracking-wider flex items-center gap-2">
                            <span class="w-3 h-3 bg-accent animate-pulse"></span> 다운로드 진행률
                        </span>
                        <span class="bg-black text-white px-2 py-0.5 text-xs font-bold" id="progressPercent">0%</span>
                    </div>
                    <div class="w-full h-6 bg-[#f0f0f0] border-2 border-black rounded-none overflow-hidden">
                        <div class="h-full bg-accent rounded-none w-0 transition-[width] duration-300" id="progressBar"></div>
                    </div>
                </div>

                <p class="text-[11px] text-[#888] leading-relaxed">
                    네트워크 환경에 따라 수 분이 소요될 수 있습니다. 이 페이지를 닫지 마세요.
                </p>

                <!-- Error Area -->
                <div class="mt-6 bg-black text-[#FF5252] border-2 border-black p-4 rounded-none text-sm font-black shadow-[4px_4px_0_0_#FF5252]"
                    id="errorArea" style="display: none;">
                    <p class="mb-3">설치 중 오류가 발생했습니다.</p>
                    <button
                        class="px-5 h-9 border border-[#FF5252] rounded-none text-xs font-black cursor-pointer transition-all duration-200 whitespace-nowrap inline-flex items-center justify-center uppercase bg-[#FF5252] text-black hover:bg-white hover:text-[#FF5252]"
                        onclick="location.reload()">
                        다시 시도
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const es = new EventSource('/api/setup-status');
        es.onmessage = function(e) {
            const data = JSON.parse(e.data);
            document.getElementById('progressBar').style.width = data.percent + '%';
            document.getElementById('progressPercent').textContent = data.percent + '%';
            if (data.message) {
                document.getElementById('statusMsg').textContent = data.message;
            }
        };
        es.addEventListener('done', function() {
            es.close();
            window.location.href = '/';
        });
        es.addEventListener('error', function(e) {
            es.close();
            document.getElementById('errorArea').style.display = 'block';
        });
    </script>
</body>

</html>
